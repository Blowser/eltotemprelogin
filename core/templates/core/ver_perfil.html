{% extends 'core/base.html' %}
{% load static %}
{% block content %}

<section class="container mt-5">
  <div class="perfil-clan p-4 rounded shadow">
    <h2 class="text-warning text-center">ðŸ§™ Perfil del usuario</h2>
    <p><strong>Usuario:</strong> {{ usuario.user.username }}</p>
    <p><strong>Nombre:</strong> {{ usuario.nombre }} {{ usuario.apellido }}</p>
    <p><strong>Rol:</strong> {{ usuario.rol.tipo_rol }}</p>
    <p><strong>Fecha de creaciÃ³n:</strong> {{ usuario.fecha_creacion|date:"d M Y H:i" }}</p>
  </div>
<h3 class="text-secondary mt-5">ðŸ“œ Historial de pedidos</h3>
{% if pedidos %}
  <ul class="list-group">
    {% for pedido in pedidos %}
      <li class="list-group-item">
        Pedido #{{ pedido.id }} â€” {{ pedido.fecha_pedido|date:"d M Y H:i" }} â€” {{ pedido.estado_pedido }} â€” ${{ pedido.precio_final }}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p class="text-muted">No tienes pedidos registrados aÃºn.</p>
{% endif %}

  <div class="metodo-pago mt-4 p-4 rounded shadow bg-light">
    <h3 class="text-primary">ðŸ’³ MÃ©todo de pago</h3>
    {% if metodo %}
      <p><strong>Tipo:</strong> {{ metodo.tipo }}</p>
      <p><strong>Nombre del titular:</strong> {{ metodo.nombre_titular }}</p>
      <p><strong>NÃºmero de tarjeta:</strong> **** **** **** {{ metodo.numero_tarjeta|slice:"-4:" }}</p>
      <p><strong>Vencimiento:</strong> {{ metodo.vencimiento }}</p>
      <p><strong>Estado:</strong> {{ metodo.estado }}</p>
      <a href="{% url 'editar_metodo_pago' %}" class="btn btn-outline-warning">Modificar mÃ©todo de pago</a>
    {% else %}
      <p class="text-muted">No tienes mÃ©todo de pago registrado.</p>
      <a href="{% url 'agregar_metodo_pago' %}" class="btn btn-success">Agregar mÃ©todo de pago</a>
    {% endif %}
  </div>
</section>

{% endblock %}
